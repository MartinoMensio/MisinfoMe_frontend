<div>
  <h1>Misinformed-me?</h1>
  <p>It is hard to distinguish fact from fiction on social media.</p>
  <p>Assess your Twitter profile, we will verify if your posts contain some detected misinformation.</p>
  <mat-card>
    <form (ngSubmit)="onSubmit()">
      <mat-form-field>
        <mat-label for="screen_name">Your Twitter screen name</mat-label>
        <input matInput placeholder="Twitter screen name" required="true" name="screen_name" [(ngModel)]="screen_name">
      </mat-form-field>
      <button type="submit" mat-raised-button color="accent">Assess</button>
      <p>Your screen name is the part after the '@', e.g. <i>realDonaldTrump</i></p>
    </form>
  </mat-card>
  <p></p>
  <!-- <app-graph [data]="data_for_graph"></app-graph> -->
  <div *ngIf="show_you">
    <mat-card>
      <mat-spinner *ngIf="loading_you"></mat-spinner>
      <div *ngIf="error_you">Error! Something is wrong in the communication with the backend!</div>
      <div *ngIf="!loading_you && !error_you">
        <h3>You</h3>
        <div>We retrieved {{result_you.tweets_cnt}} tweets</div>
        <div>Your score is: {{result_you.score | number : '1.2-2'}}% (0% is linked to misinformation, 50% is unverified, 100% is valid)</div>
        This is how the URLs that you shared are distirbuted
        <ngx-charts-advanced-pie-chart [view]="[1000,200]" [scheme]="colorScheme" [results]="pie_data_you" [gradient]="gradient">
        </ngx-charts-advanced-pie-chart>
      </div>
    </mat-card>
    <div *ngIf="!error_you">
      <mat-divider></mat-divider>
      <mat-expansion-panel>
        <mat-expansion-panel-header>
          <mat-panel-title class="bad">
              <i class="material-icons md-48">error</i>The misinforming URLs you shared
          </mat-panel-title>
          <mat-panel-description>
            Click to expand
          </mat-panel-description>
        </mat-expansion-panel-header>

        <p>For these URLs we know that they are not good. They may have been fact-checked or simply come from known
          domains that share fake content.</p>

        <app-table-tweets [data]="table_data_bad"></app-table-tweets>

      </mat-expansion-panel>
      <mat-expansion-panel>
        <mat-expansion-panel-header>
          <mat-panel-title class="good">
              <i class="material-icons md-48">check_circle</i>The verified URLs you shared
          </mat-panel-title>
          <mat-panel-description>
            Click to expand
          </mat-panel-description>
        </mat-expansion-panel-header>

        <p>Tor these URLs we know that they are good. They may relate to fact-checking articles or come from well known
          domains.</p>

        <app-table-tweets [data]="table_data_good"></app-table-tweets>

      </mat-expansion-panel>
      <mat-expansion-panel>
        <mat-expansion-panel-header>
          <mat-panel-title>
            The controversial URLs you shared
          </mat-panel-title>
          <mat-panel-description>
            Click to expand
          </mat-panel-description>
        </mat-expansion-panel-header>

        <p>For these URLs we cannot assert their truthiness but some of our datasets suggest different points of view
          so that you get a more complete idea of the problems discussed.</p>


      </mat-expansion-panel>
    </div>
  </div>
  <p></p>
  <mat-card *ngIf="!loading_overall && !error_overall && !loading_you && !error_you && show_you">
    <div>
      <h3>You against the average user</h3>
      <div>The comparison between your score and the average user score</div>
      <ngx-charts-bar-horizontal [view]="[1000,150]" [scheme]="colorScheme" [results]="you_vs_average" legend="true"
        xScaleMax="100" xAxis="true" showDataLabel="true" yAxis="true" showXAxisLabel="true" xAxisLabel="Score"
        [xAxisTicks]="[0, 25, 50, 75, 100]"></ngx-charts-bar-horizontal>
      <div style="height: 100px;"></div>
      <div>
        <p *ngIf="result_you.score < result_overall.score" class="bad"><i class="material-icons md-48">error</i> You
          seem to be worse than average</p>
        <p *ngIf="result_you.score > result_overall.score" class="good"><i class="material-icons md-24">check_circle</i>
          You seem to be better than average</p>
      </div>
    </div>
  </mat-card>
  <p></p>
  <mat-card>
    <mat-spinner *ngIf="loading_overall"></mat-spinner>
    <div *ngIf="error_overall">Error! Something is wrong in the communication with the backend!</div>
    <div *ngIf="!loading_overall && !error_overall">
      <h3>How our assessment works</h3>
      <div>
        <p>We look at your Twitter profile. For those tweets with URLs, we verify whether they have been already detected as misinformation by fact-checkers/experts.</p>
        <p> We have analysed {{result_overall.tweets_cnt}} tweets so far.</p>
      </div>
      <ngx-charts-advanced-pie-chart label="URLs encountered" [view]="[1000,200]" [scheme]="colorScheme" [results]="pie_data_overall" [gradient]="gradient"></ngx-charts-advanced-pie-chart>
      <p><a [routerLink]="['/about']">More about our verification process</a></p>
    </div>
  </mat-card>
</div>