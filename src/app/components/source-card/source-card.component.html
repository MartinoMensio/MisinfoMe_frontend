<mat-card class="mat-elevation-z8">
    <h2>{{sourceAssessment.itemReviewed}}</h2>
    <div fxLayout="row wrap" fxLayout.xs="column" fxLayoutGap="10px" fxLayoutAlign="start stretch">
        <!-- first column: general info and aggregated indicator -->
        <div>
            <h3>Computed credibility</h3>
            <app-credibility-meter [credibility]='sourceAssessment.credibility' [size]="200"></app-credibility-meter>
        </div>
        <!-- second column: details and source assessments -->
        <div style="max-width: calc(100% - 200px - 10px);">
            <div>
                <h3>Source-level assessments</h3>
                <div fxLayout="column" fxLayoutGap="10px">
                    <div *ngIf="!sourceAssessment.assessments.length">
                        <p>No one rated this source directly.</p>
                    </div>
                    <div *ngFor="let assessment of sourceAssessment.assessments">
                        <div fxLayout="row" fxLayoutGap="20px">
                            <div fxFlex="250px">
                                <h4>{{assessment.origin.name}}</h4>
                                <p>{{assessment.origin.description}}</p>

                            </div>
                            <div>
                                <p>Why should I trust this origin?</p>
                                <p>How much weight has this origin?</p>
                                <p>{{assessment.weights.final_weight}}</p>
                            </div>
                            <a mat-raised-button matTooltip="See the assessment" [href]="assessment.url"
                                target="_blank">
                                <app-credibility-meter [credibility]='assessment.credibility'></app-credibility-meter>
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="full-width">
            <h3>Fact-check analysis</h3>
            <p>How many times claims belonging to this source have been fact-checked</p>
            <div *ngIf="!factcheckingReports">No factchecks found for this source!</div>
            <div *ngIf="factcheckingReports">
                <div fxLayout="row">
                    <a mat-raised-button matTooltip="See the assessment" target="_blank">
                        <!-- [href]="factcheckingReports.url" -->
                        <app-credibility-meter [credibility]='factcheckingReports.credibility' [size]="150">
                        </app-credibility-meter>
                    </a>
                    <div class="chart-container full-width">
                        <ngx-charts-bar-horizontal-stacked [results]="chartData" [scheme]="colorScheme" [yAxis]="true"
                            [xAxis]="true" [legend]="true"></ngx-charts-bar-horizontal-stacked>
                    </div>
                </div>
                <div>
                    <mat-expansion-panel class="mat-elevation-z5">
                        <mat-expansion-panel-header>
                            <mat-panel-title>
                                Details of fact-checking report
                            </mat-panel-title>
                            <mat-panel-description>
                                Click to expand
                            </mat-panel-description>
                        </mat-expansion-panel-header>
                        <div>
                            <h2>These are reports published by fact-checkers</h2>

                            <mat-card class="table-container-2 mat-elevation-z5">
                                <div *ngFor=" let d of byFactchecker; let i=index">
                                    <div *ngIf="d.origin_id">
                                        {{d.origin_id}}:
                                        <ul>
                                            <li *ngIf="d.negative">
                                                {{d.negative.length}} times as fake:
                                                <a *ngFor="let fc of d.negative; let i = index" href="{{fc}}"
                                                    target="_blank">[{{i+1}}]</a>
                                            </li>
                                            <li *ngIf="d.positive">
                                                {{d.positive.length}} times as true:
                                                <a *ngFor="let fc of d.positive; let i = index" href="{{fc}}"
                                                    target="_blank">[{{i+1}}]</a>
                                            </li>
                                            <li *ngIf="d.mixed">
                                                {{d.mixed.length}} times as mixed:
                                                <a *ngFor="let fc of d.mixed; let i = index" href="{{fc}}"
                                                    target="_blank">[{{i+1}}]</a>
                                            </li>
                                            <li *ngIf="d.unknown">
                                                {{d.unknown.length}} times as unknown:
                                                <a *ngFor="let fc of d.unknown; let i = index" href="{{fc}}"
                                                    target="_blank">[{{i+1}}]</a>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                            </mat-card>
                        </div>

                    </mat-expansion-panel>
                </div>
            </div>
        </div>
    </div>

</mat-card>